/api/v1/videos:
  get:
    summary: Get all videos
    description: Fetches a paginated list of all published videos. Supports search, sort, and filter by user.
    tags: [Videos]
    security:
      - bearerAuth: []
    parameters:
      - in: query
        name: page
        schema: { type: integer, default: 1 }
        description: Page number for pagination
      - in: query
        name: limit
        schema: { type: integer, default: 10 }
        description: Number of videos per page
      - in: query
        name: query
        schema: { type: string }
        description: Search term to filter videos by title or description
      - in: query
        name: sortBy
        schema: { type: string, default: createdAt }
        description: Field to sort by (e.g. createdAt, views)
      - in: query
        name: sortType
        schema: { type: string, enum: [asc, desc], default: desc }
        description: Sort direction
      - in: query
        name: userId
        schema: { type: string }
        description: Filter videos by a specific user/channel ID
    responses:
      200:
        description: Videos fetched successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                statusCode: { type: number, example: 200 }
                data:
                  type: object
                  properties:
                    docs:
                      type: array
                      items:
                        type: object
                        properties:
                          _id: { type: string }
                          videoFile: { type: string }
                          thumbnail: { type: string }
                          title: { type: string }
                          description: { type: string }
                          duration: { type: number }
                          views: { type: number }
                          isPublished: { type: boolean }
                          owner:
                            type: object
                            properties:
                              userName: { type: string }
                              fullname: { type: string }
                              avatar: { type: string }
                    totalDocs: { type: number }
                    page: { type: number }
                    totalPages: { type: number }
                message: { type: string, example: "Videos fetched successfully" }
      401:
        description: Unauthorized - User not authenticated

  post:
    summary: Publish a video
    description: Uploads a video file and thumbnail to Cloudinary and creates a new video document.
    tags: [Videos]
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            required:
              - title
              - description
              - videoFile
              - thumbnail
            properties:
              title: { type: string, description: Video title }
              description: { type: string, description: Video description }
              videoFile: { type: string, format: binary, description: Video file to upload }
              thumbnail: { type: string, format: binary, description: Thumbnail image file }
    responses:
      201:
        description: Video published successfully
      400:
        description: Bad Request - Missing title, description, video file, or thumbnail
      401:
        description: Unauthorized - User not authenticated
      500:
        description: Internal Server Error - File upload failed

/api/v1/videos/{videoId}:
  get:
    summary: Get video by ID
    description: Fetches a single video by its ID. Increments view count and adds the video to the authenticated user's watch history.
    tags: [Videos]
    security:
      - bearerAuth: []
    parameters:
      - in: path
        name: videoId
        required: true
        schema: { type: string }
        description: The ID of the video
    responses:
      200:
        description: Video fetched successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                statusCode: { type: number, example: 200 }
                data:
                  type: object
                  properties:
                    _id: { type: string }
                    videoFile: { type: string }
                    thumbnail: { type: string }
                    title: { type: string }
                    description: { type: string }
                    duration: { type: number }
                    views: { type: number }
                    isPublished: { type: boolean }
                    likesCount: { type: number }
                    isLiked: { type: boolean }
                    owner:
                      type: object
                      properties:
                        userName: { type: string }
                        fullname: { type: string }
                        avatar: { type: string }
                message: { type: string, example: "Video fetched successfully" }
      400:
        description: Bad Request - Invalid video ID
      401:
        description: Unauthorized - User not authenticated
      404:
        description: Not Found - Video not found

  patch:
    summary: Update a video
    description: Updates the title, description, and/or thumbnail of a video. Only the video owner can update it.
    tags: [Videos]
    security:
      - bearerAuth: []
    parameters:
      - in: path
        name: videoId
        required: true
        schema: { type: string }
        description: The ID of the video to update
    requestBody:
      required: false
      content:
        multipart/form-data:
          schema:
            type: object
            properties:
              title: { type: string, description: Updated video title }
              description: { type: string, description: Updated video description }
              thumbnail: { type: string, format: binary, description: New thumbnail image file }
    responses:
      200:
        description: Video updated successfully
      400:
        description: Bad Request - Invalid video ID
      401:
        description: Unauthorized - User not authenticated
      403:
        description: Forbidden - Not authorized to update this video
      404:
        description: Not Found - Video not found
      500:
        description: Internal Server Error - Thumbnail upload failed

  delete:
    summary: Delete a video
    description: Deletes a video by its ID. Only the video owner can delete it.
    tags: [Videos]
    security:
      - bearerAuth: []
    parameters:
      - in: path
        name: videoId
        required: true
        schema: { type: string }
        description: The ID of the video to delete
    responses:
      200:
        description: Video deleted successfully
      400:
        description: Bad Request - Invalid video ID
      401:
        description: Unauthorized - User not authenticated
      403:
        description: Forbidden - Not authorized to delete this video
      404:
        description: Not Found - Video not found

/api/v1/videos/toggle/publish/{videoId}:
  patch:
    summary: Toggle video publish status
    description: Toggles the published/unpublished state of a video. Only the video owner can toggle it.
    tags: [Videos]
    security:
      - bearerAuth: []
    parameters:
      - in: path
        name: videoId
        required: true
        schema: { type: string }
        description: The ID of the video
    responses:
      200:
        description: Video publish status toggled successfully
      400:
        description: Bad Request - Invalid video ID
      401:
        description: Unauthorized - User not authenticated
      403:
        description: Forbidden - Not authorized to toggle publish status
      404:
        description: Not Found - Video not found
